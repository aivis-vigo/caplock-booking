<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/layout :: head('Booking Details')}"></head>
<body>
<nav th:replace="~{fragments/layout :: nav}"></nav>

<main>
    <div class="page-header">
        <h1>Booking Details</h1>
        <a class="btn btn-ghost" th:href="@{/bookings/}">← Back</a>
    </div>

    <div style="display:grid; grid-template-columns:1fr 1fr; gap:1.5rem;">

        <!-- Booking card -->
        <div class="card">
            <h2>Booking</h2>
            <dl class="kv">
                <dt>Booking ID</dt>
                <dd>
                    <code style="font-size:.8125rem; background:#f1f5f9; padding:.15rem .4rem; border-radius:4px;"
                          th:text="${bookingDetails.bookingDto.id}">—</code>
                </dd>

                <dt>Status</dt>
                <dd>
                    <span class="badge"
                          th:classappend="${bookingDetails.bookingDto.status != null
                                          and bookingDetails.bookingDto.status.name() == 'Processed'} ? 'badge-blue'
                                        : (${bookingDetails.bookingDto.status != null
                                          and bookingDetails.bookingDto.status.name() == 'Fulfilled'} ? 'badge-green'
                                        : (${bookingDetails.bookingDto.status != null
                                          and bookingDetails.bookingDto.status.name() == 'Cancelled'} ? 'badge-red' : 'badge-yellow'))"
                          th:text="${bookingDetails.bookingDto.status}">—</span>
                </dd>

                <dt>User ID</dt>
                <dd th:text="${bookingDetails.bookingDto.userId}">—</dd>
            </dl>

            <div style="margin-top:1.5rem; display:flex; gap:.75rem;">
                <form th:action="@{/bookings/delete/{id}(id=${bookingDetails.bookingDto.id})}" method="post">
                    <button type="submit" class="btn btn-danger"
                            onclick="return confirm('Cancel this booking?');">Cancel Booking</button>
                </form>
                <a class="btn btn-edit"
                   th:if="${bookingDetails.eventDto != null}"
                   th:href="@{/bookings/form/{eventId}/{id}(eventId=${bookingDetails.eventDto.id}, id=${bookingDetails.bookingDto.id})}">
                    Edit
                </a>
            </div>
        </div>

        <!-- Event card -->
        <div class="card">
            <h2>Event</h2>

            <p class="empty" th:if="${bookingDetails.eventDto == null}">Event information not available.</p>

            <dl class="kv" th:if="${bookingDetails.eventDto != null}">
                <dt>Event ID</dt>
                <dd th:text="${bookingDetails.eventDto.id}">—</dd>

                <dt>Title</dt>
                <dd th:text="${bookingDetails.eventDto.title}">—</dd>

                <dt>Date</dt>
                <dd th:text="${bookingDetails.eventDto.eventDate != null
                              ? #temporals.format(bookingDetails.eventDto.eventDate, 'MMM d, yyyy HH:mm')
                              : '—'}">—</dd>

                <dt>Location</dt>
                <dd th:text="${bookingDetails.eventDto.location}">—</dd>

                <dt>Duration</dt>
                <dd th:text="${bookingDetails.eventDto.duration != null ? bookingDetails.eventDto.duration + ' min' : '—'}">—</dd>

                <dt>Status</dt>
                <dd th:text="${bookingDetails.eventDto.status}">—</dd>

                <dt>Category</dt>
                <dd th:text="${bookingDetails.eventDto.category}">—</dd>
            </dl>

            <div style="margin-top:1rem;" th:if="${bookingDetails.eventDto != null}">
                <a class="btn btn-view"
                   th:href="@{/events/details/view/{id}(id=${bookingDetails.eventDto.id})}">
                    View Event
                </a>
            </div>
        </div>

    </div>
</main>
</body>
</html>
