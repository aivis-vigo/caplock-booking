<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Seats</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; max-width: 900px; }
        .card { border: 1px solid #ddd; border-radius: 8px; padding: 16px; margin-bottom: 16px; }
        .row { display: flex; gap: 20px; flex-wrap: wrap; }
        .col { flex: 1; min-width: 280px; }
        .label { display:block; font-weight: bold; margin: 10px 0 6px; }
        .muted { color: #666; }
        .pill { display:inline-block; padding: 2px 8px; border-radius: 999px; background: #f0f0f0; font-size: 12px; margin-left: 8px; }
        input, select, textarea { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; }
        select[multiple] { min-height: 220px; }
        .actions { display: flex; gap: 10px; margin-top: 14px; }
        .btn { padding: 10px 16px; border: 0; border-radius: 6px; cursor: pointer; font-size: 14px; }
        .btn-primary { background: #4CAF50; color: #fff; }
        .btn-cancel { background: #999; color: #fff; text-decoration: none; display: inline-block; }
        .error { color: #b00020; margin-top: 6px; }
        .grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(90px, 1fr)); gap:10px; }
        .kv { margin: 0; }
        .kv dt { font-weight: bold; }
        .kv dd { margin: 0 0 8px; }
    </style>
</head>
<body>

<h1>Book Seats</h1>

<!-- Optional: show error message from controller -->
<div class="card" th:if="${errorMessage != null}">
    <div class="error" th:text="${errorMessage}">Something went wrong</div>
</div>

<form class="card" th:object="${bookingForm}" th:action="@{/bookings/submitForm}" method="post">

    <!-- Hidden fields that must be posted -->
    <input type="hidden" th:field="*{eventId}">
    <input type="hidden" th:field="*{userId}">
    <!-- Optional if you support editing bookings -->
    <input type="hidden" th:field="*{bookingId}">
    <!-- Optional if you keep status in form -->
    <input type="hidden" th:field="*{status}">

    <div class="row">
        <!-- Event details (read-only display) -->
        <div class="col">
            <div class="card">
                <h2 style="margin-top:0;">
                    <span th:text="*{eventTitle}">Event Title</span>
                    <span class="pill">Read-only</span>
                </h2>

                <dl class="kv">
                    <dt>Event ID</dt>
                    <dd th:text="*{eventId}">1</dd>

                    <dt>Date</dt>
                    <dd>
            <span th:if="*{eventDate != null}"
                  th:text="${#temporals.format(bookingForm.eventDate, 'yyyy-MM-dd HH:mm')}">2026-02-20 10:00</span>
                        <span th:if="*{eventDate == null}" class="muted">—</span>
                    </dd>

                    <dt>Start time</dt>
                    <dd>
            <span th:if="*{eventStartTime != null}"
                  th:text="${#temporals.format(bookingForm.eventStartTime, 'yyyy-MM-dd HH:mm')}">2026-02-20 10:00</span>
                        <span th:if="*{eventStartTime == null}" class="muted">—</span>
                    </dd>

                    <dt>Location</dt>
                    <dd th:text="*{eventLocation}">Location</dd>
                </dl>

                <p class="muted" style="margin:0;">
                    Choose one or more seats on the right, then submit your booking.
                </p>
            </div>
        </div>

        <!-- Booking input -->
        <div class="col">
            <div class="card">
                <h2 style="margin-top:0;">Select seats</h2>

                <label class="label" for="seats">Available seats</label>
                <select id="seats" multiple th:field="*{seats}">
                    <!-- Controller must provide availableSeats: List<String> -->
                    <option th:each="s : ${availableSeats}" th:value="${s}" th:text="${s}">A1</option>
                </select>

                <!-- Optional: show validation errors if you use BindingResult -->
                <div class="error" th:if="${#fields.hasErrors('seats')}" th:errors="*{seats}">
                    Seats error
                </div>

                <div class="actions">
                    <button type="submit" class="btn btn-primary">Submit booking</button>
                    <a class="btn btn-cancel" th:href="@{/bookings/}">Cancel</a>
                </div>

                <!-- Optional: show what userId is (read-only, not editable) -->
                <p class="muted" style="margin:12px 0 0;">
                    Booking for user ID: <strong th:text="*{userId}">1</strong>
                </p>
            </div>
        </div>
    </div>
</form>

</body>
</html>
